---
layout: post
title: "Multi Linear Regression Model"
subtitle: "Mathematical foundations of algorithms and their practical applications by building code
implementations from scratch."
date: 2025-09-30 10:45:13 -0400
background: '/img/posts/LR-01.jpg'
categories: [statistics, regression, ml]
---

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Understanding Linear Regression: A Step-by-Step Guide</title>

    <!-- MathJax for LaTeX rendering -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
    <style>
        /* Page background (kept from original) */
        body {
            background: url('/img/trig.gif') center center / cover no-repeat fixed;
            background-size: cover;
            background-attachment: fixed;
            padding: 0;
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            color: #111;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            /* optional: prevent selection via CSS for modern browsers (original used JS too) */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Content container for better contrast */
        .content {
            background: rgba(255, 255, 255, 0.92);
            max-width: 1000px;
            margin: 30px auto;
            padding: 28px;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
        }

        h1 {
            margin-top: 0;
            font-size: 30px;
        }

        h2 {
            font-size: 22px;
            margin: 14px 0;
        }

        h3 {
            font-size: 18px;
            margin: 12px 0;
        }

        h4 {
            font-size: 16px;
            margin: 10px 0;
        }

        p {
            text-align: justify;
        }

        code {
            background: #f5f5f5;
            padding: 3px 6px;
            border-radius: 4px;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: 12px 0 22px;
        }

        table th,
        table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        table th {
            background: #f8f8f8;
        }

        .img-fluid {
            display: block;
            max-width: 100%;
            height: auto;
            margin: 14px 0;
        }

        .github-link {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            font-style: italic;
            font-size: 16px;
            margin-top: 20px;
        }

        .github-link img {
            width: 40px;
            height: 40px;
            margin-right: 8px;
        }

        /* Back to top button */
        #myBtn {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 30px;
            z-index: 99;
            font-size: 15px;
            border: none;
            outline: none;
            background-color: rgb(238, 208, 37);
            color: white;
            cursor: pointer;
            padding: 10px;
            border-radius: 4px;
        }

        #myBtn:hover {
            background-color: #555;
        }

        /* Make code blocks responsive */
        pre {
            overflow-x: auto;
            background: #f7f7f7;
            padding: 12px;
            border-radius: 6px;
        }

        /* Put this inside <style> in the <head> */
        .math-display {
            overflow-x: auto !important;
            /* Adds horizontal scroll if still too wide */
            white-space: normal !important;
            word-break: break-word !important;
        }

        mjx-container[jax="CHTML"][display="true"] {
            overflow-x: auto;
            display: block;
            max-width: 100%;
        }


        /* üåô Dark mode styles */
        body.dark-mode {
            background-color: #121212 !important;
            color: #f0f0f0 !important;
        }

        body.dark-mode .content {
            background: rgba(30, 30, 30, 0.92) !important;
            color: #f0f0f0 !important;
        }

        body.dark-mode pre {
            background: #1e1e1e !important;
            color: #f0f0f0 !important;
        }

        /* Toggle button styling */
        .toggle-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            background: #333;
            color: #fff;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .toggle-btn:hover {
            background: #555;
        }

        /* Force tables to respect container width */
        .table-wrapper {
            max-width: 100%;
            overflow-x: auto;
            /* horizontal scroll if needed */
            -webkit-overflow-scrolling: touch;
            /* smoother on mobile */
        }

        /* Make the table itself shrink/scroll, not stretch page */
        .table-wrapper table {
            width: max-content;
            /* only as wide as its content */
            min-width: 100%;
            /* but at least fill container width */
            border-collapse: collapse;
        }

        .table-wrapper th,
        .table-wrapper td {
            white-space: nowrap;
            /* prevent numbers from breaking awkwardly */
            padding: 8px;
            border: 1px solid #ddd;
            text-align: center;
        }
    </style>

</head>

<body>
    <!-- üåô Dark Mode Toggle Button -->
    <button id="darkModeToggle" class="toggle-btn">üåô Dark Mode</button>

    <div class="content">
        <script>
            // üåô Dark mode toggle logic
            const toggleBtn = document.getElementById("darkModeToggle");
            toggleBtn.addEventListener("click", () => {
                document.body.classList.toggle("dark-mode");
                toggleBtn.textContent = document.body.classList.contains("dark-mode")
                    ? "‚òÄÔ∏è"
                    : "üåô ";
            });
        </script>

        <button onclick="topFunction()" id="myBtn" title="Back to top" aria-label="Back to top">
            <img class="img-fluid" src="/img/posts/arrow.jpg" height="30" width="30" alt="Back to top">
        </button>

        <!-- ‚úÖ ‚úÖ ‚úÖ BLOGPOST CONTENT STARTS HERE ‚úÖ ‚úÖ ‚úÖ -->

        <h1>Multiple Linear Regression: A Step-by-Step Explanation</h1>

        <p>
            In the previous post on <a href="/_posts/2025-09-30-simple-linear-regression.html"><strong>Simple Linear
                    Regression</strong></a>,
            we saw how a single predictor explains a response variable.
            But in most real problems, one factor is never enough. For house prices, salary prediction, or stock
            returns, multiple
            factors interact simultaneously.
        </p>
        <p>
            This post introduces <strong>Multiple Linear Regression (MLR)</strong>. You will see:
        </p>
        <ul>
            <li>What MLR is and why it matters</li>
            <li>How the equation is derived step by step</li>
            <li>A complete worked example with a dataset</li>
            <li>Interpretation of results</li>
            <li>Key assumptions and references</li>
        </ul>
        <hr>
        <h2>1. The Idea Behind Multiple Linear Regression</h2>
        <p>Multiple Linear Regression extends simple regression by allowing more predictors:</p>

        <p style="text-align:center;">
            \[ y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p + \varepsilon \]
        </p>

        <ul>
            <li>\(y\): outcome (dependent variable)</li>
            <li>\(x_1, x_2, \dots, x_p\): predictors (independent variables)</li>
            <li>\(\beta_0\): intercept</li>
            <li>\(\beta_j\): slope/partial effect of predictor \(j\)</li>
            <li>\(\varepsilon\): error term</li>
        </ul>

        <p><strong>Interpretation:</strong> Each coefficient \(\beta_j\) measures the effect of predictor \(x_j\)
            on \(y\), <em>while holding all other predictors constant</em>. This ‚Äúceteris paribus‚Äù interpretation
            is what makes MLR powerful.</p>
        <hr>

        <h2>2. Deriving the Equations</h2>

        <h3>2.1 Least Squares Principle</h3>
        <p>
            The goal is to choose coefficients so that the predicted values are as close as possible to the actual
            values.
            This is done by minimizing the <strong>sum of squared errors (SSE)</strong>:
        </p>

        <p style="text-align:center;">
            \[ SSE = \sum_{i=1}^n \bigl(y_i - \hat{y}_i\bigr)^2 \]
        </p>

        <p>where the fitted values are:</p>

        <p style="text-align:center;">
            \[ \hat{y}_i = b_0 + b_1 x_{1i} + b_2 x_{2i} \]
        </p>

        <p>Taking partial derivatives with respect to \(b_0, b_1, b_2\) and setting them equal to zero gives the
            <strong>normal equations</strong>. In matrix form:
        </p>

        <p style="text-align:center;">
            \[ \mathbf{b} = (X^\top X)^{-1} X^\top y \]
        </p>

        <p>
            In practice, we usually compute this using sums of cross-products of deviations from the mean,
            which makes the derivation more intuitive (and easier to compute by hand).
        </p>
        <hr>

        <h2>3. Example Dataset</h2>

        <p>Consider a small dataset of house prices based on two predictors: area and number of bedrooms.</p>

        <table>
            <tr>
                <th>House</th>
                <th>Area (sq.ft)</th>
                <th>Bedrooms</th>
                <th>Price (k$)</th>
            </tr>
            <tr>
                <td>1</td>
                <td>1000</td>
                <td>2</td>
                <td>250</td>
            </tr>
            <tr>
                <td>2</td>
                <td>1500</td>
                <td>3</td>
                <td>400</td>
            </tr>
            <tr>
                <td>3</td>
                <td>2000</td>
                <td>4</td>
                <td>450</td>
            </tr>
            <tr>
                <td>4</td>
                <td>2500</td>
                <td>3</td>
                <td>500</td>
            </tr>
            <tr>
                <td>5</td>
                <td>3000</td>
                <td>5</td>
                <td>550</td>
            </tr>
        </table>
        <hr>

        <h2>4. Step-by-Step Solution</h2>

        <h3>Step 1: Compute Means</h3>
        <p>First, compute the mean of each variable:</p>

        <p style="text-align:center;">
            \[
            \bar{x}_1 = \frac{\sum x_{1i}}{n}, \quad
            \bar{x}_2 = \frac{\sum x_{2i}}{n}, \quad
            \bar{y} = \frac{\sum y_i}{n}
            \]
        </p>

        <p>Substituting values:</p>

        <p style="text-align:center;">
            \[
            \bar{x}_1 = 2000, \quad
            \bar{x}_2 = 3.4, \quad
            \bar{y} = 430
            \]
        </p>
        <hr>

        <h3>Step 2: Deviations</h3>
        <p>Subtract the mean from each observation to calculate deviations:</p>

        <p style="text-align:center;">
            \[
            x_{1i}' = x_{1i} - \bar{x}_1, \quad
            x_{2i}' = x_{2i} - \bar{x}_2, \quad
            y_i' = y_i - \bar{y}
            \]
        </p>

        <p>Example (House 1):</p>

        <p style="text-align:center;">
            \[
            x_{11}' = (1000 - 2000) = -1000, \quad
            x_{21}' = (2 - 3.4) = -1.4, \quad
            y_1' = (250 - 430) = -180
            \]
        </p>

        <table>
            <tr>
                <th>House</th>
                <th>x1</th>
                <th>x1 - xÃÑ1</th>
                <th>x2</th>
                <th>x2 - xÃÑ2</th>
                <th>y</th>
                <th>y - »≥</th>
            </tr>
            <tr>
                <td>1</td>
                <td>1000</td>
                <td>-1000</td>
                <td>2</td>
                <td>-1.4</td>
                <td>250</td>
                <td>-180</td>
            </tr>
            <tr>
                <td>2</td>
                <td>1500</td>
                <td>-500</td>
                <td>3</td>
                <td>-0.4</td>
                <td>400</td>
                <td>-30</td>
            </tr>
            <tr>
                <td>3</td>
                <td>2000</td>
                <td>0</td>
                <td>4</td>
                <td>+0.6</td>
                <td>450</td>
                <td>+20</td>
            </tr>
            <tr>
                <td>4</td>
                <td>2500</td>
                <td>+500</td>
                <td>3</td>
                <td>-0.4</td>
                <td>500</td>
                <td>+70</td>
            </tr>
            <tr>
                <td>5</td>
                <td>3000</td>
                <td>+1000</td>
                <td>5</td>
                <td>+1.6</td>
                <td>550</td>
                <td>+120</td>
            </tr>
        </table>
        <hr>

        <h3>Step 3: Cross-Products</h3>
        <p>Now we compute the sums of squares and covariances using the deviations. General forms:</p>

        <p style="text-align:center;">
            \[
            S_{x_1x_1} = \sum (x_{1i}')^2, \quad
            S_{x_2x_2} = \sum (x_{2i}')^2, \quad
            S_{x_1y} = \sum (x_{1i}'y_i')
            \]
            \[
            S_{x_2y} = \sum (x_{2i}'y_i'), \quad
            S_{x_1x_2} = \sum (x_{1i}'x_{2i}')
            \]
        </p>

        <p>Each entry is just multiplying deviations row by row. Example (House 1):</p>

        <p style="text-align:center;">
            \[
            (x_{11}' \cdot y_1') = (-1000)(-180) = 180{,}000
            \]
        </p>

        <table>
            <tr>
                <th>House</th>
                <th>(x1 - xÃÑ1)^2</th>
                <th>(x2 - xÃÑ2)^2</th>
                <th>(x1 - xÃÑ1)(y - »≥)</th>
                <th>(x2 - xÃÑ2)(y - »≥)</th>
                <th>(x1 - xÃÑ1)(x2 - xÃÑ2)</th>
            </tr>
            <tr>
                <td>1</td>
                <td>1,000,000</td>
                <td>1.96</td>
                <td>180,000</td>
                <td>252</td>
                <td>1400</td>
            </tr>
            <tr>
                <td>2</td>
                <td>250,000</td>
                <td>0.16</td>
                <td>15,000</td>
                <td>12</td>
                <td>200</td>
            </tr>
            <tr>
                <td>3</td>
                <td>0</td>
                <td>0.36</td>
                <td>0</td>
                <td>12</td>
                <td>0</td>
            </tr>
            <tr>
                <td>4</td>
                <td>250,000</td>
                <td>0.16</td>
                <td>35,000</td>
                <td>-28</td>
                <td>-200</td>
            </tr>
            <tr>
                <td>5</td>
                <td>1,000,000</td>
                <td>2.56</td>
                <td>120,000</td>
                <td>192</td>
                <td>1600</td>
            </tr>
            <tr>
                <th>Sum</th>
                <th>2,500,000</th>
                <th>5.2</th>
                <th>350,000</th>
                <th>440</th>
                <th>3000</th>
            </tr>
        </table>
        <hr>

        <h3>Step 4: Normal Equations</h3>
        <p>From these sums we set up the equations for \(b_1, b_2\):</p>

        <p style="text-align:center;">
            \[
            S_{x_1x_1} b_1 + S_{x_1x_2} b_2 = S_{x_1y}
            \]
            \[
            S_{x_1x_2} b_1 + S_{x_2x_2} b_2 = S_{x_2y}
            \]
        </p>

        <p>Substituting numbers:</p>

        <p style="text-align:center;">
            \[
            2{,}500{,}000 b_1 + 3000 b_2 = 350{,}000
            \]
            \[
            3000 b_1 + 5.2 b_2 = 440
            \]
        </p>
        <hr>

        <h3>Step 5: Solve</h3>
        <p>From the second equation we isolate \(b_2\):</p>

        <p style="text-align:center;">
            \[
            b_2 = \frac{440 - 3000 b_1}{5.2}
            \]
        </p>

        <p>Substitute into the first equation:</p>

        <p style="text-align:center;">
            \[
            2{,}500{,}000 b_1 + 3000 \left(\frac{440 - 3000 b_1}{5.2}\right) = 350{,}000
            \]
        </p>

        <p>After simplifying:</p>

        <p style="text-align:center;">
            \[
            b_1 \approx 0.05435, \quad b_2 \approx 53.26
            \]
        </p>
        <hr>

        <h3>Step 6: Intercept</h3>
        <p>The intercept is found by:</p>

        <p style="text-align:center;">
            \[
            b_0 = \bar{y} - b_1 \bar{x}_1 - b_2 \bar{x}_2
            \]
        </p>

        <p>Substitute values:</p>

        <p style="text-align:center;">
            \[
            b_0 = 430 - (0.05435)(2000) - (53.26)(3.4) \approx 140.3
            \]
        </p>

        <p><strong>Final regression equation:</strong></p>

        <p style="text-align:center; font-size:1.1em; font-weight:bold;">
            \[
            \hat{y} = 140.3 + 0.05435 x_1 + 53.26 x_2
            \]
        </p>
        <hr>

        <h2>5. Prediction Example</h2>
        <p>Predict the price of a 2200 sq.ft house with 4 bedrooms:</p>

        <p style="text-align:center;">
            \[
            \hat{y} = 140.3 + 0.05435(2200) + 53.26(4) \approx 472.8 \ \text{(k\$)}
            \]
        </p>
        <hr>

        <h2>6. Assumptions & Pitfalls</h2>
        <ul>
            <li><strong>Linearity:</strong> The relationship between predictors and response is linear.</li>
            <li><strong>No multicollinearity:</strong> Predictors should not be too strongly correlated.</li>
            <li><strong>Homoscedasticity:</strong> Errors have constant variance.</li>
            <li><strong>Independence:</strong> Errors are independent of each other.</li>
            <li><strong>Normality (for inference):</strong> Residuals should be approximately normal.</li>
        </ul>
        <hr>

        <h2>Conclusion</h2>
        <p>
            Multiple Linear Regression extends the one-predictor case by balancing contributions from multiple
            variables.
            We derived the formula step-by-step, solved an example, and interpreted the coefficients.
        </p>
        <p>
            In practice, MLR is widely used in predictive modeling ‚Äî simple enough to explain, yet powerful enough for
            real applications.
        </p>
        <hr>

        <h2>References</h2>
        <ul>
            <li><a href="https://www.wiley.com/en-us/Introduction+to+Linear+Regression+Analysis%2C+6th+Edition-p-9781119714704"
                    target="_blank">Montgomery, D.C., Peck, E.A., & Vining, G.G. (2021). <em>Introduction to Linear
                        Regression Analysis</em> (6th ed.). Wiley.</a></li>
            <li><a href="https://www.statlearning.com/" target="_blank">James, G., Witten, D., Hastie, T., & Tibshirani,
                    R. (2021). <em>An Introduction to Statistical Learning</em> (2nd ed.). Springer (free online).</a>
            </li>
            <li><a href="https://www.wiley.com/en-us/Applied+Linear+Regression%2C+3rd+Edition-p-9780471704085"
                    target="_blank">Weisberg, S. (2005). <em>Applied Linear Regression</em> (3rd ed.). Wiley.</a></li>
        </ul>
        <!-- ‚úÖ ‚úÖ ‚úÖ BLOGPOST CONTENT END HERE ‚úÖ ‚úÖ ‚úÖ -->

        <p style="text-align: left;" class="github-link">
            <a href="https://github.com/PR-Peri/Linear-Regression-Model-From-Scratch/" title="Link to GitHub Repository"
                style="color: #0000FF; text-decoration: none;">
                <img src="https://git-scm.com/images/logos/downloads/Git-Icon-Black.png" alt="Git icon">
                GitHub Repository
            </a>
        </p>
    </div>
    <script>
        // Message shown on right-click (keeps original behavior)
        const message = "Right- Click Function Disabled!";

        // Right-click: alert message and prevent default context menu
        document.addEventListener('contextmenu', function (e) {
            try { alert(message); } catch (err) { /* fallback: no-op */ }
            e.preventDefault();
        });

        // Prevent certain dev-key combos (F12, Ctrl+Shift+I/C/J, Ctrl+U)
        document.addEventListener('keydown', function (e) {
            // Normalize key for comparisons
            const key = (e.key || '').toUpperCase();

            // F12
            if (e.key === 'F12' || e.keyCode === 123) {
                e.preventDefault();
                return false;
            }

            // Ctrl+Shift+(I/J/C)
            if (e.ctrlKey && e.shiftKey && (key === 'I' || key === 'J' || key === 'C')) {
                e.preventDefault();
                return false;
            }

            // Ctrl+U (view-source / page source)
            if (e.ctrlKey && key === 'U') {
                e.preventDefault();
                return false;
            }
        });

        // Disable text selection and most mouse-driven selection actions (older-browsers compatibility)
        function disableselect(e) { return false; }
        function reEnable() { return true; }

        // Legacy handlers retained for compatibility (keeps original intent)
        document.onselectstart = disableselect; // IE/Old browsers
        if (window.sidebar) { // Netscape / old browsers
            document.onmousedown = disableselect;
            document.onclick = reEnable;
        }

        // Back-to-top button logic
        const mybutton = document.getElementById("myBtn");
        window.onscroll = function () { scrollFunction(); };

        function scrollFunction() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                mybutton.style.display = "block";
            } else {
                mybutton.style.display = "none";
            }
        }

        function topFunction() {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
        }
    </script>
</body>

</html>