<!-- ✅ Styles for Related Articles -->
<style>
    .related-article-box {
        min-height: 230px;
        min-width: 100px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        padding: 1rem;
        border: 1px solid #ddd;
        border-radius: 6px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        background: rgba(237, 235, 235, 0.85);
        transition: transform 0.2s ease, background 0.3s ease;
    }

    .related-article-box:hover {
        transform: translateY(-4px);
    }

    .related-article-box h4 {
        margin: 0 0 0.5rem;
        font-size: 1.1rem;
        color: #222;
    }

    .related-article-box img {
        width: 80px;
        height: 80px;
        object-fit: cover;
        border-radius: 6px;
    }

    .related-article-box p {
        font-size: 0.9rem;
        color: #555;
        margin: 0;
        line-height: 1.5;
    }

    .related-article-box .read-more {
        font-size: 0.9rem;
        font-weight: 500;
        color: #007bff;
    }

    .keyword-heading {
        color: #007bff;
        background: rgba(181, 176, 176, 0.7);
        padding: 8px 12px;
        border-radius: 6px;
        display: inline-block;
        margin-bottom: 1rem;
    }
</style>

<!-- ✅ Related Articles Block -->
{% assign current_tags = page.tags %}
{% assign related_posts = "" | split: "" %}

{% for post in site.posts %}
{% if post.url != page.url %}
{% assign overlap = "" | split: "" %}
{% for tag in post.tags %}
{% if current_tags contains tag %}
{% assign overlap = overlap | push: tag %}
{% endif %}
{% endfor %}
{% if overlap.size > 0 %}
{% assign related_posts = related_posts | push: post %}
{% endif %}
{% endif %}
{% endfor %}

{% assign related_posts = related_posts | slice: 0, 2 %}

{% if related_posts.size == 0 %}
{% assign related_posts = site.posts | where_exp: "p", "p.url != page.url" | slice: 0, 2 %}
{% endif %}

{% if related_posts.size > 0 %}
<hr>
<h3 class="keyword-heading">Related Articles</h3>

<div class="row">
    {% for post in related_posts %}
    <div class="col-md-6 mb-4 d-flex">
        <div class="related-article-box w-100">
            <a href="{{ post.url | relative_url }}"
                class="related-article-link text-decoration-none d-flex flex-column flex-grow-1">

                <h4>{{ post.title }}</h4>

                <div class="d-flex align-items-start flex-grow-1" style="gap: 16px;">
                    {% if post.background %}
                    <img src="{{ post.background }}" alt="{{ post.title }}">
                    {% else %}
                    <img src="/assets/images/placeholder.png" alt="No Image">
                    {% endif %}

                    <p>
                        {{ post.description | strip_html | truncatewords: 12 }}
                    </p>
                </div>

                <span class="read-more mt-2">Read More →</span>
            </a>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}